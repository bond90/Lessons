/*! Remodal - v0.1.4 - 2014-04-06
 * https://github.com/VodkaBears/remodal
 * Copyright (c) 2014 VodkaBears; */
(function(e){"use strict";function f(r,i){this.settings=e.extend({},n,i);this.modal=r;this.buildDOM();this.addEventListeners();this.index=e[t].lookup.push(this)-1;this.busy=false}var t="remodal",n={hashTracking:true};e[t]={lookup:[]};var r,i;var s=function(e){var t=e.css("transition-duration")||e.css("-webkit-transition-duration")||e.css("-moz-transition-duration")||e.css("-o-transition-duration")||e.css("-ms-transition-duration")||0;var n=e.css("transition-delay")||e.css("-webkit-transition-delay")||e.css("-moz-transition-delay")||e.css("-o-transition-delay")||e.css("-ms-transition-delay")||0;return(parseFloat(t)+parseFloat(n))*1e3};var o=function(){var e=document.createElement("div");e.style.visibility="hidden";e.style.width="100px";document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%";e.appendChild(n);var r=n.offsetWidth;e.parentNode.removeChild(e);return t-r};var u=function(){e("html, body").addClass(t+"_lock");e(document.body).css("padding-right","+="+o())};var a=function(){e("html, body").removeClass(t+"_lock");e(document.body).css("padding-right","-="+o())};f.prototype.buildDOM=function(){this.body=e(document.body);this.bg=e("."+t+"-bg");this.modalClose=e("<a href='#'>").addClass(t+"-close");this.overlay=e("<div>").addClass(t+"-overlay");if(!this.modal.hasClass(t)){this.modal.addClass(t)}this.modal.css("visibility","visible");this.modal.append(this.modalClose);this.overlay.append(this.modal);this.body.append(this.overlay);this.confirm=this.modal.find("."+t+"-confirm");this.cancel=this.modal.find("."+t+"-cancel");var n=s(this.overlay),r=s(this.modal),i=s(this.bg);this.td=r>n?r:n;this.td=i>this.td?i:this.td};f.prototype.addEventListeners=function(){var n=this;this.modalClose.bind("click."+t,function(e){e.preventDefault();n.close()});this.cancel.bind("click."+t,function(e){e.preventDefault();n.modal.trigger("cancel");n.close()});this.confirm.bind("click."+t,function(e){e.preventDefault();n.modal.trigger("confirm");n.close()});e(document).bind("keyup."+t,function(e){if(e.keyCode===27){n.close()}});this.overlay.bind("click."+t,function(r){var i=e(r.target);if(!i.hasClass(t+"-overlay")){return}n.close()})};f.prototype.open=function(){if(this.busy){return}this.busy=true;this.modal.trigger("open");var n=this.modal.attr("data-"+t+"-id");if(n&&this.settings.hashTracking){i=e(window).scrollTop();location.hash=n}if(r&&r!==this){r.overlay.hide();r.body.removeClass(t+"_active")}r=this;u();this.overlay.show();var s=this;setTimeout(function(){s.body.addClass(t+"_active");setTimeout(function(){s.busy=false;s.modal.trigger("opened")},s.td+50)},25)};f.prototype.close=function(){if(this.busy){return}this.busy=true;this.modal.trigger("close");if(this.settings.hashTracking&&this.modal.attr("data-"+t+"-id")===location.hash.substr(1)){location.hash="";e(window).scrollTop(i)}this.body.removeClass(t+"_active");var n=this;setTimeout(function(){n.overlay.hide();a();n.busy=false;n.modal.trigger("closed")},n.td+50)};if(e){e["fn"][t]=function(n){var r;this["each"](function(i,s){var o=e(s);if(!o.data(t)){r=new f(o,n);o.data(t,r.index);if(r.settings.hashTracking&&o.attr("data-"+t+"-id")===location.hash.substr(1)){r.open()}}});return r}}e(document).on("click","[data-"+t+"-target]",function(n){n.preventDefault();var r=n.currentTarget,i=r.getAttribute("data-"+t+"-target"),s=e("[data-"+t+"-id="+i+"]");e[t].lookup[s.data(t)].open()});e(document).find("."+t).each(function(n,r){var i=e(r),s=i.data(t+"-options");if(!s){s={}}i[t](s)});var l=function(n,i){var s=location.hash.replace("#","");if(typeof i==="undefined"){i=true}if(!s){if(i){if(r&&!r.busy&&r.settings.hashTracking){r.close()}}}else{var o=e("[data-"+t+"-id="+s.replace(new RegExp("/","g"),"\\/")+"]");if(o.length){var u=e[t].lookup[o.data(t)];if(u&&u.settings.hashTracking){u.open()}}}};e(window).bind("hashchange."+t,l)})(window["jQuery"]||window["Zepto"]);